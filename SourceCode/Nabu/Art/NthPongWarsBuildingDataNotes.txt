Nth Pong Wars Sound and Music and Screen Building Notes

Uses ChipNSFX music player library and Tracker editor.
Which you can get from http://cngsoft.no-ip.org/chipnsfx.htm
AGMS20250409

Nth Pong Wars Music and Sound Effects Assignments.

Which channels play which kind of sound effects...

Channel 0, 1: Purely Tone effects (there is only one noise generator).
Channel 2: White noise based effects, and tone effects.

Music should use the same white noises only in channel 5 rule,
for its channels 3, 4, 5.  Since due to bugs, channel 3 doesn't work once
noise effects start playing.  So there are only 2 music channels: 3, 4.

Effects Tracks, have a $F0 end opcode at the end of each sound so music will be
heard after the sound effect:
0 - Empty
1 - Wall Bip (use channel 0 or 1)
2 - Tile Bip (use channel 1 or 0)
3 - Harvest (use channel 2)  Instrument xxxxNxxxxxx player number 1-4 variation.
4 - Ball on Ball (use channel 2)


Compiling Music

Generate the data file in assembler from the .chp music file by using:
CHIPNSFX -v -l _NthMusic_ -L NthPongWarsMusic.chp NthPongWarsMusic.asm
CHIPNSFX -v -l _NthEffects_ -L NthPongWarsEffects.chp NthPongWarsEffects.asm

Though for effects, put just one track per channel when saving to get a pure
effect track data block and copy the resulting assembler for that effect into
our NthPongWarsExtractedEffects.asm file.

Then manually append a line at the bottom of each .asm file which exports the
symbols for use from C, like this:
PUBLIC _NthMusic_a_z, _NthMusic_a, _NthMusic_b, _NthMusic_c

Optionally for loading music rather than having it built into the program, can
convert assembler to relative binary data with a song header with:
CHIPNSFX -v -L LOADSONG.CHP LOADSONG.ASM
z80asm -v -l -m -b -o=LOADSONG.CHIPNSFX LOADSONG.ASM


Building Full Screen *.NFUL Graphics

Full screen graphics uses graphics mode 2, the file is *.NFUL which is 6K of
patterns (tile fonts) followed by 6K of colours (tile colours).  Unlike the
SC2 format, which is a raw dump of all TMS19918A video memory, it doesn't
have a 7 byte header with a copy of the registers.  The name table is assumed
to be set to the identity function (position X maps to name X for each of
3 bands of 256 tiles) and no sprites are used.  Can be generated by
Convert9918 (needs Windows 10?) at https://github.com/tursilion/convert9918
or by the web browser tool Dithertron, available at:
https://8bitworkshop.com/dithertron/#sys=msx

So, make your graphics in whatever tool (I use GIMP), save to 256x192 pixel PNG,
then use the Dithertron to convert it (often with dithering turned off for logo
solid colour graphics made using colours in the TMS9918A palette).  You may have
to make things bigger or adjust pixel boundaries to fit into the two different
colours per character cell scan line rule.  Rename the Dithertron output file
to *.NFUL and put a copy in "Documents/NABU Internet Adapter/Store/NTHPONG/" for
the NABU Internet Adapter fake NABU network server to use.  Or put a copy on my
web site (http://www.agmsmith.ca/NTHPONG/), which gets used if there isn't one
on your local Internet Adapter directory.


Building Character and Sprite Screen *.NSCR Graphics

This graphics mode 2 format has a 32x24 character screen image (768 bytes),
a font (2048 bytes for 256 8x8 pixel characters), colours for the font
(2048 bytes, 2 colours specified for each scan line in each font character), 
sprite bitmap definitions (2048 bytes, for 64 16x16 pixel sprites), and colours
for the sprites (64 bytes, we do colours differently so this gets ignored).

It's used for the screen when playing the game (besides an ASCII font, animated
power-ups and other tiles are done as special characters).  Players are made
from 16x16 sprites, with extra layers of sprites to show active power-ups on the
player.

The original file is *.DAT created by ICVGM (a Windows tool, works in Windows
2000, I use version 3.3.0 for mode 2 graphics, can get it from
https://nabu.ca/downloads-quiver).  The file is a hex ASCII listing of the
video memory layout.

I did have some code to load the ASCII *.DAT file and convert it on the fly
into binary, but that takes 5 times longer than loading the binary, due to the
sheer file size difference.

So to convert *.DAT into *.NSCR, copy the *.DAT to a *.asm file, use an
editor or regex to append ":" after each (NAME/PATTERN/MCOLOR/SPATT/SCOLOR)
symbol, or just remove them.  Try to keep the original file without colons
around so you can edit it again with ICVGM.  Then assemble the colonised
file with:
z80asm -v -l -m -b -o=NTHPONG1.NSCR NthPong1.asm
Remember to save a copy to the NABU Internet Adapter's Store/NTHPONG/ folder,
and to my web server.

